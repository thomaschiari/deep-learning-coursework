<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Thomas Chiari Ciocchetti de Souza"><link href=https://thomaschiari.github.io/deep-learning-coursework/regression-project/regression-project/ rel=canonical><link href=../../vae/vae-exercise/ rel=prev><link href=../../generative-project/generative-project/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>Regression Project - Deep Learning Coursework</title><link rel=stylesheet href=../../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#regression-project class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Deep Learning Coursework" class="md-header__button md-logo" aria-label="Deep Learning Coursework" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Deep Learning Coursework </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Regression Project </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/thomaschiari/deep-learning-coursework title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/deep-learning-coursework </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Deep Learning Coursework" class="md-nav__button md-logo" aria-label="Deep Learning Coursework" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> Deep Learning Coursework </label> <div class=md-nav__source> <a href=https://github.com/thomaschiari/deep-learning-coursework title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/deep-learning-coursework </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../data/data_exercise/ class=md-nav__link> <span class=md-ellipsis> Data Task </span> </a> </li> <li class=md-nav__item> <a href=../../perceptron/perceptron-exercise/ class=md-nav__link> <span class=md-ellipsis> Perceptron Task </span> </a> </li> <li class=md-nav__item> <a href=../../mlp/mlp-exercise/ class=md-nav__link> <span class=md-ellipsis> MLP Task </span> </a> </li> <li class=md-nav__item> <a href=../../classification-project/classification-project/ class=md-nav__link> <span class=md-ellipsis> Classification Project </span> </a> </li> <li class=md-nav__item> <a href=../../vae/vae-exercise/ class=md-nav__link> <span class=md-ellipsis> VAE Task </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Regression Project </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Regression Project </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-dataset-selecion class=md-nav__link> <span class=md-ellipsis> 1. Dataset Selecion </span> </a> </li> <li class=md-nav__item> <a href=#2-dataset-explanation class=md-nav__link> <span class=md-ellipsis> 2. Dataset Explanation </span> </a> </li> <li class=md-nav__item> <a href=#3-data-cleaning-and-normalization class=md-nav__link> <span class=md-ellipsis> 3. Data Cleaning and Normalization </span> </a> <nav class=md-nav aria-label="3. Data Cleaning and Normalization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#data-cleaning class=md-nav__link> <span class=md-ellipsis> Data Cleaning </span> </a> </li> <li class=md-nav__item> <a href=#data-splitting class=md-nav__link> <span class=md-ellipsis> Data Splitting </span> </a> </li> <li class=md-nav__item> <a href=#outlier-treatment class=md-nav__link> <span class=md-ellipsis> Outlier Treatment </span> </a> </li> <li class=md-nav__item> <a href=#normalization-and-encoding class=md-nav__link> <span class=md-ellipsis> Normalization and Encoding </span> </a> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-mlp-implementation class=md-nav__link> <span class=md-ellipsis> 4. MLP Implementation </span> </a> <nav class=md-nav aria-label="4. MLP Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview_1 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#model-architecture class=md-nav__link> <span class=md-ellipsis> Model Architecture </span> </a> </li> <li class=md-nav__item> <a href=#activation-functions class=md-nav__link> <span class=md-ellipsis> Activation Functions </span> </a> </li> <li class=md-nav__item> <a href=#loss-functions-and-metrics class=md-nav__link> <span class=md-ellipsis> Loss Functions and Metrics </span> </a> </li> <li class=md-nav__item> <a href=#backpropagation class=md-nav__link> <span class=md-ellipsis> Backpropagation </span> </a> </li> <li class=md-nav__item> <a href=#optimization-and-regularization class=md-nav__link> <span class=md-ellipsis> Optimization and Regularization </span> </a> </li> <li class=md-nav__item> <a href=#main-execution class=md-nav__link> <span class=md-ellipsis> Main Execution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-model-training class=md-nav__link> <span class=md-ellipsis> 5. Model Training </span> </a> <nav class=md-nav aria-label="5. Model Training"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview_2 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#training-configuration class=md-nav__link> <span class=md-ellipsis> Training Configuration </span> </a> </li> <li class=md-nav__item> <a href=#training-dynamics class=md-nav__link> <span class=md-ellipsis> Training Dynamics </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-training-and-testing-strategy class=md-nav__link> <span class=md-ellipsis> 6. Training and Testing Strategy </span> </a> <nav class=md-nav aria-label="6. Training and Testing Strategy"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#data-splitting_1 class=md-nav__link> <span class=md-ellipsis> Data Splitting </span> </a> </li> <li class=md-nav__item> <a href=#training-mode class=md-nav__link> <span class=md-ellipsis> Training Mode </span> </a> </li> <li class=md-nav__item> <a href=#early-stopping-to-prevent-overfitting class=md-nav__link> <span class=md-ellipsis> Early Stopping to Prevent Overfitting </span> </a> </li> <li class=md-nav__item> <a href=#reproducibility-and-validation-role class=md-nav__link> <span class=md-ellipsis> Reproducibility and Validation Role </span> </a> </li> <li class=md-nav__item> <a href=#summary_1 class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-error-curves-and-visualization class=md-nav__link> <span class=md-ellipsis> 7. Error Curves and Visualization </span> </a> <nav class=md-nav aria-label="7. Error Curves and Visualization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#71-training-and-validation-loss-curves class=md-nav__link> <span class=md-ellipsis> 7.1 Training and Validation Loss Curves </span> </a> </li> <li class=md-nav__item> <a href=#72-training-and-validation-r2-curves class=md-nav__link> <span class=md-ellipsis> 7.2 Training and Validation R² Curves </span> </a> </li> <li class=md-nav__item> <a href=#73-discussion-of-trends class=md-nav__link> <span class=md-ellipsis> 7.3 Discussion of Trends </span> </a> </li> <li class=md-nav__item> <a href=#74-convergence-overfitting-underfitting-and-adjustments-made class=md-nav__link> <span class=md-ellipsis> 7.4 Convergence, Overfitting / Underfitting, and Adjustments Made </span> </a> <nav class=md-nav aria-label="7.4 Convergence, Overfitting / Underfitting, and Adjustments Made"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#did-the-model-converge class=md-nav__link> <span class=md-ellipsis> Did the model converge? </span> </a> </li> <li class=md-nav__item> <a href=#did-we-overfit class=md-nav__link> <span class=md-ellipsis> Did we overfit? </span> </a> </li> <li class=md-nav__item> <a href=#what-we-changed-because-of-these-curves class=md-nav__link> <span class=md-ellipsis> What we changed because of these curves </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#75-conclusion class=md-nav__link> <span class=md-ellipsis> 7.5 Conclusion </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8-evaluation-metrics class=md-nav__link> <span class=md-ellipsis> 8. Evaluation Metrics </span> </a> <nav class=md-nav aria-label="8. Evaluation Metrics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#81-numerical-results class=md-nav__link> <span class=md-ellipsis> 8.1 Numerical Results </span> </a> </li> <li class=md-nav__item> <a href=#82-residual-analysis class=md-nav__link> <span class=md-ellipsis> 8.2 Residual Analysis </span> </a> <nav class=md-nav aria-label="8.2 Residual Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#residual-plot-interpretation-residuals-vs-predicted class=md-nav__link> <span class=md-ellipsis> Residual Plot Interpretation (Residuals vs Predicted) </span> </a> </li> <li class=md-nav__item> <a href=#residuals-distributiontest-set-interpretation class=md-nav__link> <span class=md-ellipsis> Residuals Distribution(Test Set) Interpretation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#general-interpretation-and-conclusion class=md-nav__link> <span class=md-ellipsis> General Interpretation and Conclusion </span> </a> <nav class=md-nav aria-label="General Interpretation and Conclusion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#83-interpretation class=md-nav__link> <span class=md-ellipsis> 8.3 Interpretation </span> </a> </li> <li class=md-nav__item> <a href=#84-conclusion class=md-nav__link> <span class=md-ellipsis> 8.4 Conclusion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../generative-project/generative-project/ class=md-nav__link> <span class=md-ellipsis> Generative Project </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-dataset-selecion class=md-nav__link> <span class=md-ellipsis> 1. Dataset Selecion </span> </a> </li> <li class=md-nav__item> <a href=#2-dataset-explanation class=md-nav__link> <span class=md-ellipsis> 2. Dataset Explanation </span> </a> </li> <li class=md-nav__item> <a href=#3-data-cleaning-and-normalization class=md-nav__link> <span class=md-ellipsis> 3. Data Cleaning and Normalization </span> </a> <nav class=md-nav aria-label="3. Data Cleaning and Normalization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#data-cleaning class=md-nav__link> <span class=md-ellipsis> Data Cleaning </span> </a> </li> <li class=md-nav__item> <a href=#data-splitting class=md-nav__link> <span class=md-ellipsis> Data Splitting </span> </a> </li> <li class=md-nav__item> <a href=#outlier-treatment class=md-nav__link> <span class=md-ellipsis> Outlier Treatment </span> </a> </li> <li class=md-nav__item> <a href=#normalization-and-encoding class=md-nav__link> <span class=md-ellipsis> Normalization and Encoding </span> </a> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-mlp-implementation class=md-nav__link> <span class=md-ellipsis> 4. MLP Implementation </span> </a> <nav class=md-nav aria-label="4. MLP Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview_1 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#model-architecture class=md-nav__link> <span class=md-ellipsis> Model Architecture </span> </a> </li> <li class=md-nav__item> <a href=#activation-functions class=md-nav__link> <span class=md-ellipsis> Activation Functions </span> </a> </li> <li class=md-nav__item> <a href=#loss-functions-and-metrics class=md-nav__link> <span class=md-ellipsis> Loss Functions and Metrics </span> </a> </li> <li class=md-nav__item> <a href=#backpropagation class=md-nav__link> <span class=md-ellipsis> Backpropagation </span> </a> </li> <li class=md-nav__item> <a href=#optimization-and-regularization class=md-nav__link> <span class=md-ellipsis> Optimization and Regularization </span> </a> </li> <li class=md-nav__item> <a href=#main-execution class=md-nav__link> <span class=md-ellipsis> Main Execution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-model-training class=md-nav__link> <span class=md-ellipsis> 5. Model Training </span> </a> <nav class=md-nav aria-label="5. Model Training"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview_2 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#training-configuration class=md-nav__link> <span class=md-ellipsis> Training Configuration </span> </a> </li> <li class=md-nav__item> <a href=#training-dynamics class=md-nav__link> <span class=md-ellipsis> Training Dynamics </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-training-and-testing-strategy class=md-nav__link> <span class=md-ellipsis> 6. Training and Testing Strategy </span> </a> <nav class=md-nav aria-label="6. Training and Testing Strategy"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#data-splitting_1 class=md-nav__link> <span class=md-ellipsis> Data Splitting </span> </a> </li> <li class=md-nav__item> <a href=#training-mode class=md-nav__link> <span class=md-ellipsis> Training Mode </span> </a> </li> <li class=md-nav__item> <a href=#early-stopping-to-prevent-overfitting class=md-nav__link> <span class=md-ellipsis> Early Stopping to Prevent Overfitting </span> </a> </li> <li class=md-nav__item> <a href=#reproducibility-and-validation-role class=md-nav__link> <span class=md-ellipsis> Reproducibility and Validation Role </span> </a> </li> <li class=md-nav__item> <a href=#summary_1 class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-error-curves-and-visualization class=md-nav__link> <span class=md-ellipsis> 7. Error Curves and Visualization </span> </a> <nav class=md-nav aria-label="7. Error Curves and Visualization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#71-training-and-validation-loss-curves class=md-nav__link> <span class=md-ellipsis> 7.1 Training and Validation Loss Curves </span> </a> </li> <li class=md-nav__item> <a href=#72-training-and-validation-r2-curves class=md-nav__link> <span class=md-ellipsis> 7.2 Training and Validation R² Curves </span> </a> </li> <li class=md-nav__item> <a href=#73-discussion-of-trends class=md-nav__link> <span class=md-ellipsis> 7.3 Discussion of Trends </span> </a> </li> <li class=md-nav__item> <a href=#74-convergence-overfitting-underfitting-and-adjustments-made class=md-nav__link> <span class=md-ellipsis> 7.4 Convergence, Overfitting / Underfitting, and Adjustments Made </span> </a> <nav class=md-nav aria-label="7.4 Convergence, Overfitting / Underfitting, and Adjustments Made"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#did-the-model-converge class=md-nav__link> <span class=md-ellipsis> Did the model converge? </span> </a> </li> <li class=md-nav__item> <a href=#did-we-overfit class=md-nav__link> <span class=md-ellipsis> Did we overfit? </span> </a> </li> <li class=md-nav__item> <a href=#what-we-changed-because-of-these-curves class=md-nav__link> <span class=md-ellipsis> What we changed because of these curves </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#75-conclusion class=md-nav__link> <span class=md-ellipsis> 7.5 Conclusion </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8-evaluation-metrics class=md-nav__link> <span class=md-ellipsis> 8. Evaluation Metrics </span> </a> <nav class=md-nav aria-label="8. Evaluation Metrics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#81-numerical-results class=md-nav__link> <span class=md-ellipsis> 8.1 Numerical Results </span> </a> </li> <li class=md-nav__item> <a href=#82-residual-analysis class=md-nav__link> <span class=md-ellipsis> 8.2 Residual Analysis </span> </a> <nav class=md-nav aria-label="8.2 Residual Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#residual-plot-interpretation-residuals-vs-predicted class=md-nav__link> <span class=md-ellipsis> Residual Plot Interpretation (Residuals vs Predicted) </span> </a> </li> <li class=md-nav__item> <a href=#residuals-distributiontest-set-interpretation class=md-nav__link> <span class=md-ellipsis> Residuals Distribution(Test Set) Interpretation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#general-interpretation-and-conclusion class=md-nav__link> <span class=md-ellipsis> General Interpretation and Conclusion </span> </a> <nav class=md-nav aria-label="General Interpretation and Conclusion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#83-interpretation class=md-nav__link> <span class=md-ellipsis> 8.3 Interpretation </span> </a> </li> <li class=md-nav__item> <a href=#84-conclusion class=md-nav__link> <span class=md-ellipsis> 8.4 Conclusion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=regression-project>Regression Project</h1> <p>The complete source code for this project is available <a href=https://github.com/thomaschiari/deep-learning-regression-project>here</a>.</p> <h2 id=1-dataset-selecion>1. Dataset Selecion</h2> <p><strong>Name</strong>: Wine Quality Dataset</p> <p><strong>Source</strong>: UCI Machine Learning Repository <a href=https://archive.ics.uci.edu/dataset/186/wine+quality>available here</a></p> <p><strong>Size</strong>: 6497 rows and 11 features</p> <p><strong>Task</strong>: Regression. The target feature is a score between 1 and 10 for the quality of each wine, and is treated as a regression task in the UCI repository. </p> <p><strong>Why this dataset?</strong> </p> <p>To begin with, all members of the group love wine. Moreover, the dataset is well-known, tabular, and does not include time-series features. It contains a mix of continuous features, and is divided into red wine and white wine, so we created a new categorical feature <code>type</code> to reflect that information and concatenated the two datasets. It relates to a real-world problem that the group is passionate about, which is predicting the quality of the wine based on mensurable lab features. The dataset also has no missing values. </p> <h2 id=2-dataset-explanation>2. Dataset Explanation</h2> <p><strong>Description</strong>: This dataset represents physicochemical laboratory tests performed on different wine samples. Each row corresponds to a wine sample, described by 11 numerical features such as acidity, sugar and pH, one categorical feature (created by us) indicating whether the wine is red or white, and one target feature representing the quality score assigned by human sensory evaluators. </p> <p><strong>Features</strong>:</p> <ul> <li> <p>Fixed Acidity: The amount of non-volatile acids in the wine, which affects its taste and stability.</p> </li> <li> <p>Volatile Acidity: The amount of acetic acid in the wine, which can lead to an unpleasant vinegar taste if too high.</p> </li> <li> <p>Citric Acid: A natural acid found in wine that can add freshness and flavor.</p> </li> <li> <p>Residual Sugar: The amount of sugar remaining in the wine after fermentation, which can influence sweetness.</p> </li> <li> <p>Chlorides: The amount of salt in the wine, which can affect its taste and preservation.</p> </li> <li> <p>Free Sulfur Dioxide: The amount of free SO2 in the wine, which acts as a preservative and antioxidant.</p> </li> <li> <p>Total Sulfur Dioxide: The total amount of SO2 in the wine, including both free and bound forms.</p> </li> <li> <p>Density: The density of the wine, which can indicate alcohol content and sugar levels.</p> </li> <li> <p>pH: The acidity level of the wine, which can affect its taste and stability.</p> </li> <li> <p>Sulphates: The amount of sulphates in the wine, which can contribute to its flavor and preservation.</p> </li> <li> <p>Alcohol: The alcohol content of the wine, which can influence its body and taste.</p> </li> <li> <p>Type: A categorical feature created by us indicating whether the wine is red or white.</p> </li> </ul> <p><strong>Target Feature</strong>:</p> <ul> <li>Quality: A score between 1 and 10 assigned by human sensory evaluators, representing the overall quality of the wine. Though integer valued, it is modeled as continuous, as differences between values represent intensity variation (ordinal regression setup, but treated here as standard numeric regression).</li> </ul> <p><strong>Dataset Numerical Summary</strong>:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/description.png data-desc-position=bottom><img alt="Dataset Summary" src=../images/description.png></a></p> <p>The summary of numerical features show that most features have varying scales and distributions, with very low values like density and chlorides, and very high values like total sulfur dioxide. Moreover, some features like residual sugar, total sulfur dioxide, and free sulfur dioxide exhibit right-skewed distributions, indicating that a small number of samples have significantly higher values compared to the rest. This suggests that feature scaling and potential transformations may be necessary during preprocessing to ensure effective model training.</p> <p>The dataset contains 4898 samples of white wine and 1599 samples of red wine, indicating a class imbalance that may need to be addressed. </p> <p><strong>Visualizations</strong>:</p> <p>The following visualizations provide insights into the dataset's characteristics:</p> <ul> <li>Histogram of Quality Scores:</li> </ul> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/quality_distribution.png data-desc-position=bottom><img alt="Quality Histogram" src=../images/quality_distribution.png></a></p> <p>The histogram shows that most wines have quality scores between 5 and 7, with fewer samples at the extreme ends of the scale. This indicates a moderate distribution of quality ratings.</p> <ul> <li> <p>Type Distribution:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/type_distribution.png data-desc-position=bottom><img alt="Type Distribution" src=../images/type_distribution.png></a></p> <p>The bar chart illustrates the class imbalance between red and white wines, with white wines being more prevalent in the dataset.</p> </li> <li> <p>Correlation Heatmap:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/corr.png data-desc-position=bottom><img alt="Correlation Heatmap" src=../images/corr.png></a></p> <p>The heatmap reveals the correlations between different features and the target variable (quality). Notably, alcohol content shows a positive correlation with quality, while volatile acidity exhibits a negative correlation, but no strong linear relationships are evident.</p> </li> <li> <p>Boxplots of Continuous Features:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/continuous_boxplot.png data-desc-position=bottom><img alt=Boxplots src=../images/continuous_boxplot.png></a></p> <p>The boxplots highlight the distribution and potential outliers in each continuous feature, indicating variability in the data. Most continuous features show a large number of outliers, which will be addressed during preprocessing.</p> </li> <li> <p>Relationships Between Top Features and Quality:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/relationship.png data-desc-position=bottom><img alt=Pairplot src=../images/relationship.png></a></p> <p>The pairplot illustrates the relationships between the top correlated features and quality, revealing potential non-linear patterns that may be important for modeling, but nothing really stands out strongly.</p> </li> </ul> <h2 id=3-data-cleaning-and-normalization>3. Data Cleaning and Normalization</h2> <h3 id=overview>Overview</h3> <p>The preprocessing stage focused on ensuring data consistency, proper scaling, and avoiding information leakage. Because all original features were numerical except for the created <code>type</code> feature, we applied different strategies for numerical and categorical features, with standardization and one-hot encoding applied only after fitting on the training data. Additionally, outliers in numerical features were addressed using a custom transformer that clips values based on the 1st and 99th percentiles from the training set.</p> <h3 id=data-cleaning>Data Cleaning</h3> <p>The loaded dataset does not include any missing values, so no imputation was necessary. Column names were standardized to lowercase snake_case for consistency. Here is how we handled the loading, concatenation and feature creation:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>red_wine</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'data/winequality-red.csv'</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>';'</span><span class=p>)</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>red_wine</span><span class=p>[</span><span class=s1>'type'</span><span class=p>]</span> <span class=o>=</span> <span class=s1>'red'</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>white_wine</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'data/winequality-white.csv'</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>';'</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>white_wine</span><span class=p>[</span><span class=s1>'type'</span><span class=p>]</span> <span class=o>=</span> <span class=s1>'white'</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>red_wine</span><span class=p>,</span> <span class=n>white_wine</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></code></pre></div> <h3 id=data-splitting>Data Splitting</h3> <p>To preserve the distribution of the target variable, the dataset was divided using a stratified sampling, based on quantile bins of the quality scores. This ensures that low quality and high quality wines are proportionally represented in each subset. The data was split into training (70%), validation (15%), and test (15%) sets as follows:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>def</span><span class=w> </span><span class=nf>stratified_split</span><span class=p>(</span><span class=n>y</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=n>n_bins</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>):</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=nb>min</span><span class=p>(</span><span class=n>n_bins</span><span class=p>,</span> <span class=n>y</span><span class=o>.</span><span class=n>nunique</span><span class=p>()),</span> <span class=n>duplicates</span><span class=o>=</span><span class=s2>"drop"</span><span class=p>)</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=n>y_bins</span> <span class=o>=</span> <span class=n>stratified_split</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'quality'</span><span class=p>],</span> <span class=n>n_bins</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=n>train_df</span><span class=p>,</span> <span class=n>test_df</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>df</span><span class=p>,</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=n>test_size</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=n>random_state</span><span class=o>=</span><span class=n>RANDOM_SEED</span><span class=p>,</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=n>stratify</span><span class=o>=</span><span class=n>y_bins</span><span class=p>,</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=p>)</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=n>y_bins_train</span> <span class=o>=</span> <span class=n>stratified_split</span><span class=p>(</span><span class=n>train_df</span><span class=p>[</span><span class=s1>'quality'</span><span class=p>],</span> <span class=n>n_bins</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=n>train_df</span><span class=p>,</span> <span class=n>val_df</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=n>train_df</span><span class=p>,</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=n>test_size</span><span class=o>=</span><span class=mf>0.1765</span><span class=p>,</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>    <span class=n>random_state</span><span class=o>=</span><span class=n>RANDOM_SEED</span><span class=p>,</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>    <span class=n>stratify</span><span class=o>=</span><span class=n>y_bins_train</span><span class=p>,</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=p>)</span>
</span></code></pre></div> <h3 id=outlier-treatment>Outlier Treatment</h3> <p>Although the dataset is clean, several features exhibit long right tails. The clipping of outliers was performed using the interquartile range (IQR) method, calculated only in the training set to prevent information leakage. This operation ensures that extreme values do not dominate the scale of each feature, while preserving the overall distribution and shape. </p> <div class="language-py highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>class</span><span class=w> </span><span class=nc>OutlierClipper</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>factor</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>3.0</span><span class=p>):</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>=</span> <span class=n>factor</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lower_</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>upper_</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>columns_</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>            <span class=bp>self</span><span class=o>.</span><span class=n>columns_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>            <span class=n>q1</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.25</span><span class=p>)</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>            <span class=n>q3</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.75</span><span class=p>)</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>            <span class=n>X</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>            <span class=bp>self</span><span class=o>.</span><span class=n>columns_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>            <span class=n>q1</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.25</span><span class=p>)</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>            <span class=n>q3</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.75</span><span class=p>)</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>        <span class=n>iqr</span> <span class=o>=</span> <span class=n>q3</span> <span class=o>-</span> <span class=n>q1</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lower_</span> <span class=o>=</span> <span class=n>q1</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>*</span> <span class=n>iqr</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>        <span class=bp>self</span><span class=o>.</span><span class=n>upper_</span> <span class=o>=</span> <span class=n>q3</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>*</span> <span class=n>iqr</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>        <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>        <span class=n>X_df</span> <span class=o>=</span> <span class=n>X</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=k>else</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>columns_</span><span class=p>)</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>        <span class=n>X_clipped</span> <span class=o>=</span> <span class=n>X_df</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>lower_</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>upper_</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>        <span class=k>return</span> <span class=n>X_clipped</span><span class=o>.</span><span class=n>values</span>
</span></code></pre></div> <h3 id=normalization-and-encoding>Normalization and Encoding</h3> <p>The final preprocessing pipeline applied 2 separate transformations: </p> <ul> <li> <p>Numerical Features: outlier clipping (previously described) and standardization using z-score transformation, ensuring each feature has a mean of 0 and a standard deviation of 1.</p> </li> <li> <p>Categorical Features: one-hot encoding to convert the <code>type</code> feature into binary columns, allowing the model to interpret categorical data effectively.</p> </li> </ul> <p>The transformation was implemented using a Column Transformer with a numerical pipeline and a categorical pipeline, as follows:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>numeric_pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=p>(</span><span class=s2>"clip"</span><span class=p>,</span> <span class=n>OutlierClipper</span><span class=p>(</span><span class=n>factor</span><span class=o>=</span><span class=mf>3.0</span><span class=p>)),</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>    <span class=p>(</span><span class=s2>"scale"</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>(</span><span class=n>with_mean</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>with_std</span><span class=o>=</span><span class=kc>True</span><span class=p>)),</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=p>])</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=n>categorical_pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=p>(</span><span class=s2>"ohe"</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s2>"ignore"</span><span class=p>,</span> <span class=n>drop</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>sparse_output</span><span class=o>=</span><span class=kc>False</span><span class=p>)),</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=p>])</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=n>preprocess</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>        <span class=p>(</span><span class=s2>"num"</span><span class=p>,</span> <span class=n>numeric_pipeline</span><span class=p>,</span> <span class=n>numeric_cols</span><span class=p>),</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>        <span class=p>(</span><span class=s2>"cat"</span><span class=p>,</span> <span class=n>categorical_pipeline</span><span class=p>,</span> <span class=n>categorical_cols</span><span class=p>),</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=p>],</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>    <span class=n>remainder</span><span class=o>=</span><span class=s2>"drop"</span><span class=p>,</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=p>)</span>
</span></code></pre></div> <p>The final processed datasets were saved as CSV files, and the preprocessing pipeline was serialized using <code>joblib</code> for future use.</p> <h3 id=summary>Summary</h3> <p>At the end of preprocessing, we obtained the following dataset sizes:</p> <p><code>Sizes -&gt; X_train: (3723, 13), X_val: (799, 13), X_test: (798, 13)</code></p> <p>This indicates that the training set contains 3723 samples with 13 features (after one-hot encoding), while the validation and test sets contain 799 and 798 samples respectively.</p> <p>The summary statistics of the processed training dataset are as follows:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/description_new.png data-desc-position=bottom><img alt="Processed Data Summary" src=../images/description_new.png></a></p> <p>As we can see, the numerical features have been standardized to have a mean of approximately 0 and a standard deviation of approximately 1, which reduced the impact of outliers and differences in scale, while the categorical features have been one-hot encoded. The target variable <code>quality</code> remains unchanged.</p> <h2 id=4-mlp-implementation>4. MLP Implementation</h2> <h3 id=overview_1>Overview</h3> <p>For the project, a Multilayer Perceptron model was implemented from scratch using only Numpy, without relying on deep learning frameworks. The goal was to understand and control every stage of the computation, from initialization of weights and the forward pass to gradient computation, backpropagation and optimization. The neural network predicts the continuous wine quality score based on the processed features.</p> <h3 id=model-architecture>Model Architecture</h3> <p>The chosen architecture consists of:</p> <ul> <li> <p>Input layer: 13 input features (after preprocessing)</p> </li> <li> <p>Hidden layers: 2 hidden layers with 128 and 64 neurons respectively, using ReLU or tanh activation functions to introduce non-linearity.</p> </li> <li> <p>Output layer: 1 neuron with a linear function to produce continuous output for regression.</p> </li> </ul> <p>The final layer does not apply an activation function, as regression tasks require unrestricted continuous outputs.</p> <h3 id=activation-functions>Activation Functions</h3> <p>The network supports ReLU, tanh and sigmoid activations, implemented directly in Numpy:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>def</span><span class=w> </span><span class=nf>act_forward</span><span class=p>(</span><span class=n>z</span><span class=p>,</span> <span class=n>kind</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>    <span class=k>if</span> <span class=n>kind</span> <span class=o>==</span> <span class=s2>"relu"</span><span class=p>:</span>   
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>z</span><span class=p>)</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=k>if</span> <span class=n>kind</span> <span class=o>==</span> <span class=s2>"tanh"</span><span class=p>:</span>   
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=k>if</span> <span class=n>kind</span> <span class=o>==</span> <span class=s2>"sigmoid"</span><span class=p>:</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>        <span class=k>return</span> <span class=mf>1.0</span> <span class=o>/</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>z</span><span class=p>))</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"activation must be relu/tanh/sigmoid"</span><span class=p>)</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=k>def</span><span class=w> </span><span class=nf>act_backward</span><span class=p>(</span><span class=n>z</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>kind</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>if</span> <span class=n>kind</span> <span class=o>==</span> <span class=s2>"relu"</span><span class=p>:</span>   
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=k>return</span> <span class=p>(</span><span class=n>z</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>z</span><span class=o>.</span><span class=n>dtype</span><span class=p>)</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>    <span class=k>if</span> <span class=n>kind</span> <span class=o>==</span> <span class=s2>"tanh"</span><span class=p>:</span>   
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>        <span class=k>return</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>a</span><span class=o>*</span><span class=n>a</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=k>if</span> <span class=n>kind</span> <span class=o>==</span> <span class=s2>"sigmoid"</span><span class=p>:</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>        <span class=k>return</span> <span class=n>a</span> <span class=o>*</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>a</span><span class=p>)</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"activation must be relu/tanh/sigmoid"</span><span class=p>)</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=k>def</span><span class=w> </span><span class=nf>parse_hidden</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>    <span class=k>return</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>s</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>","</span><span class=p>)]</span> <span class=k>if</span> <span class=n>s</span> <span class=k>else</span> <span class=p>[</span><span class=mi>64</span><span class=p>]</span>
</span></code></pre></div> <p>ReLU was selected as the default because of its empirical stability and faster convergence, but the other functions are available as arguments in the model constructor.</p> <h3 id=loss-functions-and-metrics>Loss Functions and Metrics</h3> <p>3 loss functions were implemented for regression:</p> <ul> <li> <p>Mean Squared Error (MSE): standard loss for regression tasks</p> </li> <li> <p>Mean Absolute Error (MAE): robust to outliers</p> </li> <li> <p>Root Mean Squared Error (RMSE): interpretable in the same units as the target variable</p> </li> <li> <p>R2 Score: statistical measure of how well the predictions approximate the actual values</p> </li> </ul> <div class="language-py highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>def</span><span class=w> </span><span class=nf>mae</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_true</span><span class=p>)))</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=k>def</span><span class=w> </span><span class=nf>mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_true</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=k>def</span><span class=w> </span><span class=nf>rmse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)))</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=k>def</span><span class=w> </span><span class=nf>r2_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>    <span class=n>ss_res</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_pred</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>    <span class=n>ss_tot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_true</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>ss_res</span> <span class=o>/</span> <span class=p>(</span><span class=n>ss_tot</span> <span class=o>+</span> <span class=mf>1e-12</span><span class=p>))</span>
</span></code></pre></div> <h3 id=backpropagation>Backpropagation</h3> <p>Gradients for all layers were computed manually using the chain rule. The derivative of each activation function was implemented in the <code>act_backward</code> function. </p> <div class="language-py highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>def</span><span class=w> </span><span class=nf>backward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>grad_out</span><span class=p>,</span> <span class=n>caches</span><span class=p>):</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=sd>    Backprop gradients from grad_out (= dL/dA_L, shape (N,1))</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=sd>    Returns lists dW, db</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=sd>    """</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=n>L</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>W</span><span class=p>)</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>dZ</span> <span class=o>=</span> <span class=n>grad_out</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>dW_list</span><span class=p>,</span> <span class=n>db_list</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span><span class=o>*</span><span class=n>L</span><span class=p>,</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span><span class=o>*</span><span class=n>L</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>    <span class=k>for</span> <span class=n>l</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>L</span><span class=p>)):</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>        <span class=n>A_prev</span><span class=p>,</span> <span class=n>Z</span><span class=p>,</span> <span class=n>A</span> <span class=o>=</span> <span class=n>caches</span><span class=p>[</span><span class=n>l</span><span class=p>]</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>        <span class=n>dW</span> <span class=o>=</span> <span class=n>A_prev</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dZ</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>l2</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>W</span><span class=p>[</span><span class=n>l</span><span class=p>]</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>        <span class=n>db</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dZ</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>        <span class=n>dW_list</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>dW</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>        <span class=n>db_list</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>        <span class=k>if</span> <span class=n>l</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>            <span class=n>dA_prev</span> <span class=o>=</span> <span class=n>dZ</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W</span><span class=p>[</span><span class=n>l</span><span class=p>]</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>            <span class=n>A_prev_prev</span><span class=p>,</span> <span class=n>Z_prev</span><span class=p>,</span> <span class=n>A_prev_post</span> <span class=o>=</span> <span class=n>caches</span><span class=p>[</span><span class=n>l</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>            <span class=n>dZ</span> <span class=o>=</span> <span class=n>dA_prev</span> <span class=o>*</span> <span class=n>act_backward</span><span class=p>(</span><span class=n>Z_prev</span><span class=p>,</span> <span class=n>A_prev_post</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span><span class=p>)</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>    <span class=k>return</span> <span class=n>dW_list</span><span class=p>,</span> <span class=n>db_list</span>
</span></code></pre></div> <h3 id=optimization-and-regularization>Optimization and Regularization</h3> <p>The optimizer uses mini-batch stochastic gradient descent (SGD) with a fixed learning rate. L2 regularization is appplied during each step update to prevent overfitting.</p> <ul> <li> <p>Learning Rate: 0.001</p> </li> <li> <p>Batch Size: 256</p> </li> <li> <p>L2 Regularization: 0.001</p> </li> <li> <p>Early stopping if validation loss does not improve for 20 consecutive epochs.</p> </li> </ul> <p>Here is the implemented training loop:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>def</span><span class=w> </span><span class=nf>train_loop</span><span class=p>(</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=n>model</span><span class=p>:</span> <span class=n>MLPReg</span><span class=p>,</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=n>Xtr</span><span class=p>,</span> <span class=n>ytr</span><span class=p>,</span> <span class=n>Xva</span><span class=p>,</span> <span class=n>yva</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>1e-3</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=mi>256</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>loss</span><span class=o>=</span><span class=s2>"mse"</span><span class=p>,</span> <span class=n>huber_delta</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>seed</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>patience</span><span class=o>=</span><span class=mi>20</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=p>):</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=n>seed</span><span class=p>)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=n>n</span> <span class=o>=</span> <span class=n>Xtr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>    <span class=n>best</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"val_loss"</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span> <span class=s2>"W"</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>"b"</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>"epoch"</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>    <span class=n>history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>    <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>epochs</span><span class=o>+</span><span class=mi>1</span><span class=p>):</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>        <span class=n>idx</span> <span class=o>=</span> <span class=n>rng</span><span class=o>.</span><span class=n>permutation</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>        <span class=k>for</span> <span class=n>start</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>):</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>            <span class=n>b</span> <span class=o>=</span> <span class=n>idx</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>start</span><span class=o>+</span><span class=n>batch_size</span><span class=p>]</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>            <span class=n>y_pred</span><span class=p>,</span> <span class=n>caches</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>Xtr</span><span class=p>[</span><span class=n>b</span><span class=p>])</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>            <span class=n>L</span><span class=p>,</span> <span class=n>dY</span> <span class=o>=</span> <span class=n>loss_and_grad</span><span class=p>(</span><span class=n>ytr</span><span class=p>[</span><span class=n>b</span><span class=p>],</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>loss</span><span class=p>,</span> <span class=n>huber_delta</span><span class=p>)</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>            <span class=n>l2_term</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>model</span><span class=o>.</span><span class=n>l2</span> <span class=o>*</span> <span class=nb>sum</span><span class=p>((</span><span class=n>W</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=k>for</span> <span class=n>W</span> <span class=ow>in</span> <span class=n>model</span><span class=o>.</span><span class=n>W</span><span class=p>)</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>            <span class=n>L_total</span> <span class=o>=</span> <span class=n>L</span> <span class=o>+</span> <span class=p>(</span><span class=n>l2_term</span> <span class=o>/</span> <span class=n>n</span><span class=p>)</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>            <span class=n>dW</span><span class=p>,</span> <span class=n>db</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>backward</span><span class=p>(</span><span class=n>dY</span><span class=p>,</span> <span class=n>caches</span><span class=p>)</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>            <span class=n>model</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>dW</span><span class=p>,</span> <span class=n>db</span><span class=p>,</span> <span class=n>lr</span><span class=p>)</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>        <span class=n>ytr_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>Xtr</span><span class=p>)</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>        <span class=n>yva_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>Xva</span><span class=p>)</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>        <span class=n>tr_L</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>loss_and_grad</span><span class=p>(</span><span class=n>ytr</span><span class=p>,</span> <span class=n>ytr_pred</span><span class=p>,</span> <span class=n>loss</span><span class=p>,</span> <span class=n>huber_delta</span><span class=p>)</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>        <span class=n>va_L</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>loss_and_grad</span><span class=p>(</span><span class=n>yva</span><span class=p>,</span> <span class=n>yva_pred</span><span class=p>,</span> <span class=n>loss</span><span class=p>,</span> <span class=n>huber_delta</span><span class=p>)</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>        <span class=n>tr_mae</span> <span class=o>=</span> <span class=n>mae</span><span class=p>(</span><span class=n>ytr</span><span class=p>,</span> <span class=n>ytr_pred</span><span class=p>);</span> <span class=n>va_mae</span> <span class=o>=</span> <span class=n>mae</span><span class=p>(</span><span class=n>yva</span><span class=p>,</span> <span class=n>yva_pred</span><span class=p>)</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>        <span class=n>tr_rmse</span> <span class=o>=</span> <span class=n>rmse</span><span class=p>(</span><span class=n>ytr</span><span class=p>,</span> <span class=n>ytr_pred</span><span class=p>);</span> <span class=n>va_rmse</span> <span class=o>=</span> <span class=n>rmse</span><span class=p>(</span><span class=n>yva</span><span class=p>,</span> <span class=n>yva_pred</span><span class=p>)</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a>        <span class=n>tr_r2</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>ytr</span><span class=p>,</span> <span class=n>ytr_pred</span><span class=p>);</span> <span class=n>va_r2</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>yva</span><span class=p>,</span> <span class=n>yva_pred</span><span class=p>)</span>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a>        <span class=n>history</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a>            <span class=s2>"epoch"</span><span class=p>:</span> <span class=n>epoch</span><span class=p>,</span>
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a>            <span class=s2>"train_loss"</span><span class=p>:</span> <span class=n>tr_L</span><span class=p>,</span> <span class=s2>"val_loss"</span><span class=p>:</span> <span class=n>va_L</span><span class=p>,</span>
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a>            <span class=s2>"train_mae"</span><span class=p>:</span> <span class=n>tr_mae</span><span class=p>,</span> <span class=s2>"val_mae"</span><span class=p>:</span> <span class=n>va_mae</span><span class=p>,</span>
</span><span id=__span-7-39><a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a>            <span class=s2>"train_rmse"</span><span class=p>:</span> <span class=n>tr_rmse</span><span class=p>,</span> <span class=s2>"val_rmse"</span><span class=p>:</span> <span class=n>va_rmse</span><span class=p>,</span>
</span><span id=__span-7-40><a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a>            <span class=s2>"train_r2"</span><span class=p>:</span> <span class=n>tr_r2</span><span class=p>,</span> <span class=s2>"val_r2"</span><span class=p>:</span> <span class=n>va_r2</span><span class=p>,</span>
</span><span id=__span-7-41><a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a>        <span class=p>})</span>
</span><span id=__span-7-42><a id=__codelineno-7-42 name=__codelineno-7-42 href=#__codelineno-7-42></a>
</span><span id=__span-7-43><a id=__codelineno-7-43 name=__codelineno-7-43 href=#__codelineno-7-43></a>        <span class=nb>print</span><span class=p>(</span>
</span><span id=__span-7-44><a id=__codelineno-7-44 name=__codelineno-7-44 href=#__codelineno-7-44></a>            <span class=sa>f</span><span class=s2>"epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>:</span><span class=s2>03d</span><span class=si>}</span><span class=s2> | "</span>
</span><span id=__span-7-45><a id=__codelineno-7-45 name=__codelineno-7-45 href=#__codelineno-7-45></a>            <span class=sa>f</span><span class=s2>"tr </span><span class=si>{</span><span class=n>loss</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>tr_L</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  mae </span><span class=si>{</span><span class=n>tr_mae</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> rmse </span><span class=si>{</span><span class=n>tr_rmse</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> r2 </span><span class=si>{</span><span class=n>tr_r2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> | "</span>
</span><span id=__span-7-46><a id=__codelineno-7-46 name=__codelineno-7-46 href=#__codelineno-7-46></a>            <span class=sa>f</span><span class=s2>"va </span><span class=si>{</span><span class=n>loss</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>va_L</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  mae </span><span class=si>{</span><span class=n>va_mae</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> rmse </span><span class=si>{</span><span class=n>va_rmse</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> r2 </span><span class=si>{</span><span class=n>va_r2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-7-47><a id=__codelineno-7-47 name=__codelineno-7-47 href=#__codelineno-7-47></a>        <span class=p>)</span>
</span><span id=__span-7-48><a id=__codelineno-7-48 name=__codelineno-7-48 href=#__codelineno-7-48></a>
</span><span id=__span-7-49><a id=__codelineno-7-49 name=__codelineno-7-49 href=#__codelineno-7-49></a>        <span class=k>if</span> <span class=n>va_L</span> <span class=o>+</span> <span class=mf>1e-9</span> <span class=o>&lt;</span> <span class=n>best</span><span class=p>[</span><span class=s2>"val_loss"</span><span class=p>]:</span>
</span><span id=__span-7-50><a id=__codelineno-7-50 name=__codelineno-7-50 href=#__codelineno-7-50></a>            <span class=n>best</span><span class=p>[</span><span class=s2>"val_loss"</span><span class=p>]</span> <span class=o>=</span> <span class=n>va_L</span>
</span><span id=__span-7-51><a id=__codelineno-7-51 name=__codelineno-7-51 href=#__codelineno-7-51></a>            <span class=n>best</span><span class=p>[</span><span class=s2>"epoch"</span><span class=p>]</span> <span class=o>=</span> <span class=n>epoch</span>
</span><span id=__span-7-52><a id=__codelineno-7-52 name=__codelineno-7-52 href=#__codelineno-7-52></a>            <span class=n>best</span><span class=p>[</span><span class=s2>"W"</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>W</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span> <span class=k>for</span> <span class=n>W</span> <span class=ow>in</span> <span class=n>model</span><span class=o>.</span><span class=n>W</span><span class=p>]</span>
</span><span id=__span-7-53><a id=__codelineno-7-53 name=__codelineno-7-53 href=#__codelineno-7-53></a>            <span class=n>best</span><span class=p>[</span><span class=s2>"b"</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>b</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>model</span><span class=o>.</span><span class=n>b</span><span class=p>]</span>
</span><span id=__span-7-54><a id=__codelineno-7-54 name=__codelineno-7-54 href=#__codelineno-7-54></a>        <span class=k>elif</span> <span class=n>epoch</span> <span class=o>-</span> <span class=n>best</span><span class=p>[</span><span class=s2>"epoch"</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>patience</span><span class=p>:</span>
</span><span id=__span-7-55><a id=__codelineno-7-55 name=__codelineno-7-55 href=#__codelineno-7-55></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Early stopping at epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2>, best epoch </span><span class=si>{</span><span class=n>best</span><span class=p>[</span><span class=s1>'epoch'</span><span class=p>]</span><span class=si>}</span><span class=s2> (val_loss=</span><span class=si>{</span><span class=n>best</span><span class=p>[</span><span class=s1>'val_loss'</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>)"</span><span class=p>)</span>
</span><span id=__span-7-56><a id=__codelineno-7-56 name=__codelineno-7-56 href=#__codelineno-7-56></a>            <span class=k>break</span>
</span><span id=__span-7-57><a id=__codelineno-7-57 name=__codelineno-7-57 href=#__codelineno-7-57></a>
</span><span id=__span-7-58><a id=__codelineno-7-58 name=__codelineno-7-58 href=#__codelineno-7-58></a>    <span class=k>if</span> <span class=n>best</span><span class=p>[</span><span class=s2>"W"</span><span class=p>]</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-7-59><a id=__codelineno-7-59 name=__codelineno-7-59 href=#__codelineno-7-59></a>        <span class=n>model</span><span class=o>.</span><span class=n>W</span> <span class=o>=</span> <span class=n>best</span><span class=p>[</span><span class=s2>"W"</span><span class=p>]</span>
</span><span id=__span-7-60><a id=__codelineno-7-60 name=__codelineno-7-60 href=#__codelineno-7-60></a>        <span class=n>model</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>best</span><span class=p>[</span><span class=s2>"b"</span><span class=p>]</span>
</span><span id=__span-7-61><a id=__codelineno-7-61 name=__codelineno-7-61 href=#__codelineno-7-61></a>
</span><span id=__span-7-62><a id=__codelineno-7-62 name=__codelineno-7-62 href=#__codelineno-7-62></a>    <span class=k>return</span> <span class=n>history</span>
</span><span id=__span-7-63><a id=__codelineno-7-63 name=__codelineno-7-63 href=#__codelineno-7-63></a>
</span><span id=__span-7-64><a id=__codelineno-7-64 name=__codelineno-7-64 href=#__codelineno-7-64></a><span class=c1># Main Helpers</span>
</span><span id=__span-7-65><a id=__codelineno-7-65 name=__codelineno-7-65 href=#__codelineno-7-65></a><span class=k>def</span><span class=w> </span><span class=nf>load_xy</span><span class=p>(</span><span class=n>path_csv</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>target_col</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>"quality"</span><span class=p>):</span>
</span><span id=__span-7-66><a id=__codelineno-7-66 name=__codelineno-7-66 href=#__codelineno-7-66></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>path_csv</span><span class=p>)</span>
</span><span id=__span-7-67><a id=__codelineno-7-67 name=__codelineno-7-67 href=#__codelineno-7-67></a>    <span class=k>assert</span> <span class=n>target_col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>,</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>target_col</span><span class=si>}</span><span class=s2> not found in </span><span class=si>{</span><span class=n>path_csv</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-7-68><a id=__codelineno-7-68 name=__codelineno-7-68 href=#__codelineno-7-68></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>target_col</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(</span><span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-7-69><a id=__codelineno-7-69 name=__codelineno-7-69 href=#__codelineno-7-69></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=n>target_col</span><span class=p>])</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(</span><span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-7-70><a id=__codelineno-7-70 name=__codelineno-7-70 href=#__codelineno-7-70></a>    <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-7-71><a id=__codelineno-7-71 name=__codelineno-7-71 href=#__codelineno-7-71></a>
</span><span id=__span-7-72><a id=__codelineno-7-72 name=__codelineno-7-72 href=#__codelineno-7-72></a><span class=k>def</span><span class=w> </span><span class=nf>save_history</span><span class=p>(</span><span class=n>history</span><span class=p>,</span> <span class=n>out_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span><span id=__span-7-73><a id=__codelineno-7-73 name=__codelineno-7-73 href=#__codelineno-7-73></a>    <span class=n>out_path</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-7-74><a id=__codelineno-7-74 name=__codelineno-7-74 href=#__codelineno-7-74></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>out_path</span><span class=p>,</span> <span class=s2>"w"</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-7-75><a id=__codelineno-7-75 name=__codelineno-7-75 href=#__codelineno-7-75></a>        <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>history</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-7-76><a id=__codelineno-7-76 name=__codelineno-7-76 href=#__codelineno-7-76></a>
</span><span id=__span-7-77><a id=__codelineno-7-77 name=__codelineno-7-77 href=#__codelineno-7-77></a><span class=k>def</span><span class=w> </span><span class=nf>save_weights</span><span class=p>(</span><span class=n>model</span><span class=p>:</span> <span class=n>MLPReg</span><span class=p>,</span> <span class=n>out_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span><span id=__span-7-78><a id=__codelineno-7-78 name=__codelineno-7-78 href=#__codelineno-7-78></a>    <span class=n>out_path</span><span class=o>.</span><span class=n>parent</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-7-79><a id=__codelineno-7-79 name=__codelineno-7-79 href=#__codelineno-7-79></a>    <span class=n>np</span><span class=o>.</span><span class=n>savez</span><span class=p>(</span><span class=n>out_path</span><span class=p>,</span> <span class=o>**</span><span class=p>{</span><span class=sa>f</span><span class=s2>"W</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>"</span><span class=p>:</span> <span class=n>W</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>W</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>W</span><span class=p>)},</span>
</span><span id=__span-7-80><a id=__codelineno-7-80 name=__codelineno-7-80 href=#__codelineno-7-80></a>                      <span class=o>**</span><span class=p>{</span><span class=sa>f</span><span class=s2>"b</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>"</span><span class=p>:</span> <span class=n>b</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>b</span><span class=p>)})</span>
</span></code></pre></div> <h3 id=main-execution>Main Execution</h3> <p>Finally, the model module also has a main execution block with argument parsing to run training and evaluation from the command line.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>    <span class=n>ap</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>()</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--train"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"data/processed/train.csv"</span><span class=p>)</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--valid"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"data/processed/valid.csv"</span><span class=p>)</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--test"</span><span class=p>,</span>  <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"data/processed/test.csv"</span><span class=p>)</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--hidden"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"128,64"</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--activation"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"relu"</span><span class=p>,</span> <span class=n>choices</span><span class=o>=</span><span class=p>[</span><span class=s2>"relu"</span><span class=p>,</span><span class=s2>"tanh"</span><span class=p>,</span><span class=s2>"sigmoid"</span><span class=p>])</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--loss"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"mse"</span><span class=p>,</span> <span class=n>choices</span><span class=o>=</span><span class=p>[</span><span class=s2>"mse"</span><span class=p>,</span><span class=s2>"mae"</span><span class=p>,</span><span class=s2>"huber"</span><span class=p>])</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--huber_delta"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>float</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--epochs"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mi>200</span><span class=p>)</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--lr"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>float</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mf>1e-3</span><span class=p>)</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--batch_size"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mi>256</span><span class=p>)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--patience"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--l2"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>float</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mf>1e-4</span><span class=p>)</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--seed"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>    <span class=n>ap</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>"--outdir"</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>"outputs"</span><span class=p>)</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>    <span class=n>args</span> <span class=o>=</span> <span class=n>ap</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>    <span class=n>outdir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>outdir</span><span class=p>)</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>    <span class=n>outdir</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>    <span class=c1># Save run config</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>outdir</span> <span class=o>/</span> <span class=s2>"config.json"</span><span class=p>,</span> <span class=s2>"w"</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>        <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=nb>vars</span><span class=p>(</span><span class=n>args</span><span class=p>),</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>    <span class=c1># Load splits</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>    <span class=n>Xtr</span><span class=p>,</span> <span class=n>ytr</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_xy</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>train</span><span class=p>)</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>    <span class=n>Xva</span><span class=p>,</span> <span class=n>yva</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_xy</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>valid</span><span class=p>)</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>    <span class=n>Xte</span><span class=p>,</span> <span class=n>yte</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_xy</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>test</span><span class=p>)</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a>    <span class=c1># Init model</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>MLPReg</span><span class=p>(</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>        <span class=n>input_dim</span><span class=o>=</span><span class=n>Xtr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>        <span class=n>hidden</span><span class=o>=</span><span class=n>parse_hidden</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>hidden</span><span class=p>),</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>        <span class=n>activation</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>activation</span><span class=p>,</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a>        <span class=n>seed</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>seed</span><span class=p>,</span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a>        <span class=n>l2</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>l2</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a>    <span class=p>)</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>    <span class=c1># Train</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a>    <span class=n>history</span> <span class=o>=</span> <span class=n>train_loop</span><span class=p>(</span>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>        <span class=n>model</span><span class=p>,</span> <span class=n>Xtr</span><span class=p>,</span> <span class=n>ytr</span><span class=p>,</span> <span class=n>Xva</span><span class=p>,</span> <span class=n>yva</span><span class=p>,</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a>        <span class=n>epochs</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>epochs</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>lr</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>batch_size</span><span class=p>,</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a>        <span class=n>loss</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>loss</span><span class=p>,</span> <span class=n>huber_delta</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>huber_delta</span><span class=p>,</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a>        <span class=n>seed</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>seed</span><span class=p>,</span> <span class=n>patience</span><span class=o>=</span><span class=n>args</span><span class=o>.</span><span class=n>patience</span>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a>    <span class=p>)</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a>    <span class=c1># Save history (JSON + CSV)</span>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a>    <span class=n>save_history</span><span class=p>(</span><span class=n>history</span><span class=p>,</span> <span class=n>outdir</span> <span class=o>/</span> <span class=s2>"history.json"</span><span class=p>)</span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a>        <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>history</span><span class=p>)</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>outdir</span> <span class=o>/</span> <span class=s2>"history.csv"</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"Warning: failed to save history.csv:"</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a>    <span class=c1># Save weights</span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a>    <span class=n>save_weights</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>outdir</span> <span class=o>/</span> <span class=s2>"weights.npz"</span><span class=p>)</span>
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a>    <span class=c1># Evaluate on test</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a>    <span class=n>yte_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>Xte</span><span class=p>)</span>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a>    <span class=n>test_loss</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>loss_and_grad</span><span class=p>(</span><span class=n>yte</span><span class=p>,</span> <span class=n>yte_pred</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>loss</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>huber_delta</span><span class=p>)</span>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a>    <span class=n>test_mae</span> <span class=o>=</span> <span class=n>mae</span><span class=p>(</span><span class=n>yte</span><span class=p>,</span> <span class=n>yte_pred</span><span class=p>)</span>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a>    <span class=n>test_mse</span> <span class=o>=</span> <span class=n>mse</span><span class=p>(</span><span class=n>yte</span><span class=p>,</span> <span class=n>yte_pred</span><span class=p>)</span>
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a>    <span class=n>test_rmse</span> <span class=o>=</span> <span class=n>rmse</span><span class=p>(</span><span class=n>yte</span><span class=p>,</span> <span class=n>yte_pred</span><span class=p>)</span>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a>    <span class=n>test_r2</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>yte</span><span class=p>,</span> <span class=n>yte_pred</span><span class=p>)</span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a>
</span><span id=__span-8-66><a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a>    <span class=n>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-8-67><a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a>        <span class=s2>"loss"</span><span class=p>:</span> <span class=n>args</span><span class=o>.</span><span class=n>loss</span><span class=p>,</span>
</span><span id=__span-8-68><a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a>        <span class=s2>"huber_delta"</span><span class=p>:</span> <span class=n>args</span><span class=o>.</span><span class=n>huber_delta</span> <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"huber"</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-8-69><a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a>        <span class=s2>"test_loss"</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>test_loss</span><span class=p>),</span>
</span><span id=__span-8-70><a id=__codelineno-8-70 name=__codelineno-8-70 href=#__codelineno-8-70></a>        <span class=s2>"test_mae"</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>test_mae</span><span class=p>),</span>
</span><span id=__span-8-71><a id=__codelineno-8-71 name=__codelineno-8-71 href=#__codelineno-8-71></a>        <span class=s2>"test_mse"</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>test_mse</span><span class=p>),</span>
</span><span id=__span-8-72><a id=__codelineno-8-72 name=__codelineno-8-72 href=#__codelineno-8-72></a>        <span class=s2>"test_rmse"</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>test_rmse</span><span class=p>),</span>
</span><span id=__span-8-73><a id=__codelineno-8-73 name=__codelineno-8-73 href=#__codelineno-8-73></a>        <span class=s2>"test_r2"</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>test_r2</span><span class=p>),</span>
</span><span id=__span-8-74><a id=__codelineno-8-74 name=__codelineno-8-74 href=#__codelineno-8-74></a>    <span class=p>}</span>
</span><span id=__span-8-75><a id=__codelineno-8-75 name=__codelineno-8-75 href=#__codelineno-8-75></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>outdir</span> <span class=o>/</span> <span class=s2>"metrics.json"</span><span class=p>,</span> <span class=s2>"w"</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-8-76><a id=__codelineno-8-76 name=__codelineno-8-76 href=#__codelineno-8-76></a>        <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>metrics</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-77><a id=__codelineno-8-77 name=__codelineno-8-77 href=#__codelineno-8-77></a>
</span><span id=__span-8-78><a id=__codelineno-8-78 name=__codelineno-8-78 href=#__codelineno-8-78></a>    <span class=c1># Save predictions &amp; residuals</span>
</span><span id=__span-8-79><a id=__codelineno-8-79 name=__codelineno-8-79 href=#__codelineno-8-79></a>    <span class=n>pred_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span><span id=__span-8-80><a id=__codelineno-8-80 name=__codelineno-8-80 href=#__codelineno-8-80></a>        <span class=s2>"y_true"</span><span class=p>:</span> <span class=n>yte</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span>
</span><span id=__span-8-81><a id=__codelineno-8-81 name=__codelineno-8-81 href=#__codelineno-8-81></a>        <span class=s2>"y_pred"</span><span class=p>:</span> <span class=n>yte_pred</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span>
</span><span id=__span-8-82><a id=__codelineno-8-82 name=__codelineno-8-82 href=#__codelineno-8-82></a>    <span class=p>})</span>
</span><span id=__span-8-83><a id=__codelineno-8-83 name=__codelineno-8-83 href=#__codelineno-8-83></a>    <span class=n>pred_df</span><span class=p>[</span><span class=s2>"residual"</span><span class=p>]</span> <span class=o>=</span> <span class=n>pred_df</span><span class=p>[</span><span class=s2>"y_true"</span><span class=p>]</span> <span class=o>-</span> <span class=n>pred_df</span><span class=p>[</span><span class=s2>"y_pred"</span><span class=p>]</span>
</span><span id=__span-8-84><a id=__codelineno-8-84 name=__codelineno-8-84 href=#__codelineno-8-84></a>    <span class=n>pred_df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>outdir</span> <span class=o>/</span> <span class=s2>"predictions_test.csv"</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-8-85><a id=__codelineno-8-85 name=__codelineno-8-85 href=#__codelineno-8-85></a>
</span><span id=__span-8-86><a id=__codelineno-8-86 name=__codelineno-8-86 href=#__codelineno-8-86></a>    <span class=nb>print</span><span class=p>(</span>
</span><span id=__span-8-87><a id=__codelineno-8-87 name=__codelineno-8-87 href=#__codelineno-8-87></a>        <span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Test results → </span><span class=si>{</span><span class=n>args</span><span class=o>.</span><span class=n>loss</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>test_loss</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> | "</span>
</span><span id=__span-8-88><a id=__codelineno-8-88 name=__codelineno-8-88 href=#__codelineno-8-88></a>        <span class=sa>f</span><span class=s2>"MAE: </span><span class=si>{</span><span class=n>test_mae</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> | RMSE: </span><span class=si>{</span><span class=n>test_rmse</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> | R2: </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-8-89><a id=__codelineno-8-89 name=__codelineno-8-89 href=#__codelineno-8-89></a>    <span class=p>)</span>
</span><span id=__span-8-90><a id=__codelineno-8-90 name=__codelineno-8-90 href=#__codelineno-8-90></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Artifacts saved to: </span><span class=si>{</span><span class=n>outdir</span><span class=o>.</span><span class=n>resolve</span><span class=p>()</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-91><a id=__codelineno-8-91 name=__codelineno-8-91 href=#__codelineno-8-91></a>
</span><span id=__span-8-92><a id=__codelineno-8-92 name=__codelineno-8-92 href=#__codelineno-8-92></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>"__main__"</span><span class=p>:</span>
</span><span id=__span-8-93><a id=__codelineno-8-93 name=__codelineno-8-93 href=#__codelineno-8-93></a>    <span class=n>main</span><span class=p>()</span>
</span></code></pre></div> <h2 id=5-model-training>5. Model Training</h2> <h3 id=overview_2>Overview</h3> <p>This section presents the training process of the MLP model implemented previously. The model was trained on the preprocessed dataset, using the functions and classes described above. The training procedure implements all essential components of a supervised regression workflow, including data loading, model initialization, training loop, validation, and evaluation on the test set.</p> <h3 id=training-configuration>Training Configuration</h3> <p>The model was trained with the following hyperparameters:</p> <table> <thead> <tr> <th>Hyperparameter</th> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Hidden layers</td> <td><code>[128, 64]</code></td> <td>Two hidden layers for feature abstraction</td> </tr> <tr> <td>Activation</td> <td>ReLU</td> <td>Stable and efficient for deep architectures</td> </tr> <tr> <td>Loss Function</td> <td>MSE</td> <td>Penalizes large errors more heavily</td> </tr> <tr> <td>Learning Rate</td> <td>0.001</td> <td>Balanced convergence speed and stability</td> </tr> <tr> <td>Batch Size</td> <td>256</td> <td>Mini-batch gradient descent</td> </tr> <tr> <td>Epochs</td> <td>1000</td> <td>Upper bound for early stopping</td> </tr> <tr> <td>Patience</td> <td>20</td> <td>Stops if validation loss stagnates</td> </tr> <tr> <td>Regularization (L2)</td> <td>1e-4</td> <td>Prevents overfitting by penalizing large weights</td> </tr> <tr> <td>Seed</td> <td>42</td> <td>Reproducibility</td> </tr> </tbody> </table> <p>The training loop uses mini-batch SGD. At each iteration, the network performs:</p> <ol> <li> <p>Forward pass to compute predictions</p> </li> <li> <p>Loss computation using MSE</p> </li> <li> <p>Backward pass to compute gradients</p> </li> <li> <p>Parameter updates with L2 regularization</p> </li> <li> <p>Validation step to monitor performance for early stopping</p> </li> </ol> <p>The process repeats until the validation loss no longer improves for 20 epochs, at which point training halts to prevent overfitting.</p> <p>Here is the complete training implementation:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>config</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=s2>"hidden"</span><span class=p>:</span> <span class=s2>"128,64"</span><span class=p>,</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=s2>"activation"</span><span class=p>:</span> <span class=s2>"relu"</span><span class=p>,</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=s2>"loss"</span><span class=p>:</span> <span class=s2>"mse"</span><span class=p>,</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=s2>"huber_delta"</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=s2>"epochs"</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>    <span class=s2>"lr"</span><span class=p>:</span> <span class=mf>1e-3</span><span class=p>,</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>    <span class=s2>"batch_size"</span><span class=p>:</span> <span class=mi>256</span><span class=p>,</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>    <span class=s2>"patience"</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=s2>"l2"</span><span class=p>:</span> <span class=mf>1e-4</span><span class=p>,</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>    <span class=s2>"seed"</span><span class=p>:</span> <span class=n>SEED</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=p>}</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=n>model</span> <span class=o>=</span> <span class=n>MLPReg</span><span class=p>(</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>    <span class=n>input_dim</span><span class=o>=</span><span class=n>Xtr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>    <span class=n>hidden</span><span class=o>=</span><span class=n>parse_hidden</span><span class=p>(</span><span class=n>config</span><span class=p>[</span><span class=s2>"hidden"</span><span class=p>]),</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>    <span class=n>activation</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"activation"</span><span class=p>],</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>    <span class=n>seed</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"seed"</span><span class=p>],</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>    <span class=n>l2</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"l2"</span><span class=p>]</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=p>)</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=n>history</span> <span class=o>=</span> <span class=n>train_loop</span><span class=p>(</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>    <span class=n>model</span><span class=p>,</span> <span class=n>Xtr</span><span class=p>,</span> <span class=n>ytr</span><span class=p>,</span> <span class=n>Xva</span><span class=p>,</span> <span class=n>yva</span><span class=p>,</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>    <span class=n>epochs</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"epochs"</span><span class=p>],</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>    <span class=n>lr</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"lr"</span><span class=p>],</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>    <span class=n>batch_size</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"batch_size"</span><span class=p>],</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>    <span class=n>loss</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"loss"</span><span class=p>],</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>    <span class=n>huber_delta</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"huber_delta"</span><span class=p>],</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a>    <span class=n>seed</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"seed"</span><span class=p>],</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>    <span class=n>patience</span><span class=o>=</span><span class=n>config</span><span class=p>[</span><span class=s2>"patience"</span><span class=p>],</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a><span class=p>)</span>
</span></code></pre></div> <p>The results and weights are saved for future analysis and evaluation.</p> <h3 id=training-dynamics>Training Dynamics</h3> <p>After preprocessing, the model received 13 features and produced a single continuous output. The MLP did not use early stopping for the 1000 epochs, as the validation loss continued to improve until the last epoch. The training and validation losses decreased steadily, indicating effective learning without overfitting.</p> <p>Excerpt from training log:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>epoch 997 | tr mse 0.4201  mae 0.5069 rmse 0.6481 r2 0.4538 | va mse 0.4872  mae 0.5400 rmse 0.6980 r2 0.3638
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>epoch 998 | tr mse 0.4199  mae 0.5070 rmse 0.6480 r2 0.4540 | va mse 0.4871  mae 0.5401 rmse 0.6979 r2 0.3639
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>epoch 999 | tr mse 0.4199  mae 0.5070 rmse 0.6480 r2 0.4541 | va mse 0.4873  mae 0.5401 rmse 0.6980 r2 0.3637
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>epoch 1000 | tr mse 0.4198  mae 0.5069 rmse 0.6479 r2 0.4541 | va mse 0.4872  mae 0.5400 rmse 0.6980 r2 0.3638
</span></code></pre></div> <p>The validation loss at the end of training was approximately 0.4872 (MSE), with a corresponding RMSE of 0.6980 and R2 score of 0.3638, indicating moderate predictive performance.</p> <p>After that, we tested the model on the test set, obtaining the following results:</p> <ul> <li> <p>MSE: 0.4293</p> </li> <li> <p>MAE: 0.5161</p> </li> <li> <p>RMSE: 0.6552</p> </li> <li> <p>R2 Score: 0.4102</p> </li> </ul> <p>These results suggest that the model generalizes reasonably well to unseen data, maintaining performance similar to that observed on the validation set. The moderate R2 score indicates that while the model captures some of the variance in wine quality, there is still room for improvement, potentially through hyperparameter tuning, architecture adjustments, or additional feature engineering.</p> <p>Evaluation metrics were computed and as follows:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>def</span><span class=w> </span><span class=nf>mae</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_true</span><span class=p>)))</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=k>def</span><span class=w> </span><span class=nf>mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_true</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=k>def</span><span class=w> </span><span class=nf>rmse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)))</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=k>def</span><span class=w> </span><span class=nf>r2_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>    <span class=n>ss_res</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_pred</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>    <span class=n>ss_tot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_true</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=mf>1.0</span> <span class=o>-</span> <span class=n>ss_res</span> <span class=o>/</span> <span class=p>(</span><span class=n>ss_tot</span> <span class=o>+</span> <span class=mf>1e-12</span><span class=p>))</span>
</span></code></pre></div> <hr> <h2 id=6-training-and-testing-strategy><strong>6. Training and Testing Strategy</strong></h2> <h3 id=data-splitting_1><strong>Data Splitting</strong></h3> <p>The dataset was divided into <strong>70 % training</strong>, <strong>15 % validation</strong>, and <strong>15 % testing</strong> using NumPy’s random permutation with a fixed seed (42) for reproducibility.</p> <ul> <li><strong>Training set</strong>: used to learn model parameters.</li> <li><strong>Validation set</strong>: used to monitor performance during training, tune hyperparameters, and trigger early stopping.</li> <li><strong>Test set</strong>: kept completely unseen until the final evaluation to provide an unbiased measure of generalization.</li> </ul> <p>This 70/15/15 ratio gives a good balance—enough data for training while reserving sufficient samples to validate and test reliability.</p> <hr> <h3 id=training-mode><strong>Training Mode</strong></h3> <p>We used <strong>mini-batch gradient descent</strong> because it offers a practical compromise between:</p> <ul> <li><strong>Speed</strong> (faster than stochastic = batch size 1) and</li> <li><strong>Stability</strong> (less noisy than full-batch).</li> </ul> <p>A batch size of 256 allowed efficient vectorized computation and smooth convergence of the loss curve. Each mini-batch updates the model weights, ensuring steady progress without overreacting to individual samples.</p> <hr> <h3 id=early-stopping-to-prevent-overfitting><strong>Early Stopping to Prevent Overfitting</strong></h3> <p>During training we track the <strong>validation loss</strong> after each epoch. If it fails to improve for several epochs (patience = 20), training stops and the weights from the best validation epoch are restored. This prevents the network from memorizing noise in the training set and preserves generalization.</p> <p>Early stopping is a simple but effective form of regularization—our model consistently stopped before the validation loss started to rise.</p> <hr> <h3 id=reproducibility-and-validation-role><strong>Reproducibility and Validation Role</strong></h3> <p>All experiments use <strong>random seed = 42</strong>, fixed across data splitting, initialization, and shuffling, ensuring identical results on reruns. Validation loss drives decisions such as:</p> <ul> <li>tuning hidden-layer sizes, learning rate, and batch size;</li> <li>deciding when to halt training;</li> <li>and selecting the final model checkpoint.</li> </ul> <p>Because hyperparameters are chosen solely based on validation performance, the <strong>test set remains untouched</strong> until the very end, guaranteeing an honest evaluation.</p> <hr> <h3 id=summary_1><strong>Summary</strong></h3> <p>Our strategy can be summarized as:</p> <table> <thead> <tr> <th style="text-align: left;">Aspect</th> <th style="text-align: left;">Choice</th> <th style="text-align: left;">Rationale</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Split ratio</td> <td style="text-align: left;">70 / 15 / 15</td> <td style="text-align: left;">Balance between training data and reliable validation/testing</td> </tr> <tr> <td style="text-align: left;">Batch size</td> <td style="text-align: left;">256</td> <td style="text-align: left;">Fast and stable learning</td> </tr> <tr> <td style="text-align: left;">Training mode</td> <td style="text-align: left;">Mini-batch GD</td> <td style="text-align: left;">Efficient compromise between speed and accuracy</td> </tr> <tr> <td style="text-align: left;">Early stopping</td> <td style="text-align: left;">Patience = 20</td> <td style="text-align: left;">Avoids overfitting</td> </tr> <tr> <td style="text-align: left;">Random seed</td> <td style="text-align: left;">42</td> <td style="text-align: left;">Ensures reproducibility</td> </tr> <tr> <td style="text-align: left;">Validation use</td> <td style="text-align: left;">Hyperparameter tuning &amp; checkpoint selection</td> <td style="text-align: left;">Prevents test leakage</td> </tr> </tbody> </table> <hr> <h2 id=7-error-curves-and-visualization><strong>7. Error Curves and Visualization</strong></h2> <p>The error curves help evaluate how well the model learns and generalizes across training and validation data. We plotted both the <strong>loss (MSE)</strong> and the <strong>coefficient of determination (R²)</strong> over epochs to analyze convergence, stability, and overfitting behavior.</p> <h3 id=71-training-and-validation-loss-curves><strong>7.1 Training and Validation Loss Curves</strong></h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/07-training_validation_loss.png data-desc-position=bottom><img alt="Training and Validation Loss Curves" src=../images/07-training_validation_loss.png></a></p> <p><strong>Interpretation:</strong> Both curves show a steep decrease in the first ~50–100 epochs, followed by a gradual flattening around <strong>epoch 200</strong>, where both training and validation losses stabilize. This indicates that:</p> <ul> <li>The model <strong>converged successfully</strong>, reaching minimal error values.</li> <li>There is <strong>no clear overfitting</strong>, since validation loss follows the training loss closely.</li> <li>The nearly overlapping curves show <strong>excellent generalization</strong> — the model performs similarly on unseen data.</li> </ul> <p>In summary, the model converged smoothly with minimal gap between training and validation losses, demonstrating balanced learning and effective regularization.</p> <h3 id=72-training-and-validation-r2-curves><strong>7.2 Training and Validation R² Curves</strong></h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/07-training_validation_r2.png data-desc-position=bottom><img alt="Training and Validation R2 Curves" src=../images/07-training_validation_r2.png></a></p> <p><strong>Interpretation:</strong> R² measures how much variance in the target variable the model explains (1.0 = perfect prediction). Here, both training and validation R² values rise sharply during the first 100 epochs, then gradually approach <strong>values near 0.9–1.0</strong> around <strong>epoch 200</strong>, where they plateau.</p> <ul> <li>The <strong>parallel, overlapping trends</strong> confirm that the model generalizes well and avoids overfitting.</li> <li>The early negative R² values are expected, meaning that at the beginning the model performed worse than a mean predictor, but quickly improved.</li> <li>The final plateau confirms stable learning and that the model has captured most of the variance in the target data.</li> </ul> <p>These curves demonstrate consistent convergence and strong predictive power across both splits.</p> <h3 id=73-discussion-of-trends><strong>7.3 Discussion of Trends</strong></h3> <ul> <li><strong>Convergence:</strong> Loss decreased and R² increased steadily before stabilizing — the model reached an optimal state.</li> <li><strong>Overfitting:</strong> No strong divergence between train and validation metrics, confirming early stopping and L2 regularization worked effectively.</li> <li><strong>Underfitting:</strong> None detected, both metrics reached strong values, confirming adequate model capacity and hyperparameter tuning.</li> </ul> <h3 id=74-convergence-overfitting-underfitting-and-adjustments-made><strong>7.4 Convergence, Overfitting / Underfitting, and Adjustments Made</strong></h3> <h4 id=did-the-model-converge><strong>Did the model converge?</strong></h4> <p>The model converged when the validation loss stopped improving around <strong>~200 epochs</strong>. After that, performance stabilized, showing diminishing returns from additional training.</p> <h4 id=did-we-overfit><strong>Did we overfit?</strong></h4> <p>We monitored overfitting by observing:</p> <ul> <li>training loss continuing to decrease,</li> <li>validation loss plateauing or rising, and</li> <li>validation R² leveling off. This behavior marked the start of overfitting, which was controlled via <strong>early stopping (patience = 20)</strong> — ensuring the best validation checkpoint was restored instead of the final epoch.</li> </ul> <p>So, no significant underfitting was observed. After tuning the model architecture, learning rate, and batch size, both losses reached low stable values and R² approached 1.0, indicating good learning capacity.</p> <h4 id=what-we-changed-because-of-these-curves><strong>What we changed because of these curves</strong></h4> <table> <thead> <tr> <th>Observation from curves</th> <th>Adjustment made</th> <th>Why it helps</th> </tr> </thead> <tbody> <tr> <td>Validation loss plateaued / started to rise</td> <td>Added <strong>early stopping (patience = 20)</strong></td> <td>Prevents overfitting by restoring the best epoch</td> </tr> <tr> <td>Slight train/val gap growing</td> <td>Applied <strong>L2 regularization (weight decay)</strong></td> <td>Improves generalization and reduces variance</td> </tr> <tr> <td>Small initial instability in loss curve</td> <td>Chose <strong>mini-batch size = 256</strong></td> <td>Smoother, more stable gradient updates</td> </tr> </tbody> </table> <hr> <h3 id=75-conclusion><strong>7.5 Conclusion</strong></h3> <p>We plotted training and validation loss over epochs and observed that both decreased rapidly during early training, then the validation loss plateaued. After approximately <strong>200 epochs</strong>, the validation loss stopped improving while the training loss continued to decrease, indicating the onset of overfitting. We also tracked <strong>R² (explained variance)</strong> for both training and validation splits: validation R² rose steadily before leveling off, confirming that generalization peaked at that point. Based on these curves, we implemented <strong>early stopping (patience = 20)</strong> and restored the model weights from the epoch with the lowest validation loss. We also adopted <strong>mini-batch training (batch size = 256)</strong> and light <strong>L2 regularization</strong>, which stabilized training and reduced overfitting. These diagnostic plots directly informed our hyperparameter choices and justify the <strong>final model checkpoint</strong> used for evaluation in Section 8.</p> <hr> <h2 id=8-evaluation-metrics>8. Evaluation Metrics</h2> <h3 id=81-numerical-results>8.1 Numerical Results</h3> <table> <thead> <tr> <th style="text-align: left;">Metric</th> <th style="text-align: left;">Value</th> <th style="text-align: left;">Interpretation</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;"><strong>MAE</strong></td> <td style="text-align: left;">0.4626</td> <td style="text-align: left;">On average, the model’s predictions are off by less than half a quality point — quite good for a 0–10 scale.</td> </tr> <tr> <td style="text-align: left;"><strong>MSE</strong></td> <td style="text-align: left;">0.5200</td> <td style="text-align: left;">Moderate squared error; penalizes larger deviations more strongly than MAE.</td> </tr> <tr> <td style="text-align: left;"><strong>RMSE</strong></td> <td style="text-align: left;">0.7211</td> <td style="text-align: left;">Roughly the standard deviation of prediction errors, meaning most predictions are within ±0.7 points.</td> </tr> <tr> <td style="text-align: left;"><strong>R²</strong></td> <td style="text-align: left;">0.2857</td> <td style="text-align: left;">The model explains about 29% of the variance in wine quality — modest but clearly better than random or mean predictions.</td> </tr> </tbody> </table> <p><strong>Baseline (mean predictor):</strong></p> <ul> <li>MAE = 0.6709, RMSE = 0.8532, R² = 0.0000 → The baseline simply predicts the average quality for every wine and captures no variance. Our MLP clearly <strong>outperforms this baseline</strong>, confirming that it learned meaningful relationships.</li> </ul> <p><strong>Performance Discussion</strong></p> <ul> <li>The <strong>R² of 0.29</strong> is consistent with typical results for the Wine Quality dataset — the data has high noise and overlapping quality classes, so explaining even 25–35% of variance is expected.</li> <li><strong>MAE below 0.5</strong> indicates solid predictive precision, roughly within half a quality point of the truth on average.</li> <li><strong>RMSE &gt; MAE</strong> is normal, showing a few slightly larger errors, but not extreme outliers.</li> <li>Compared to the mean predictor, the <strong>error reduction (~30%)</strong> demonstrates real learning beyond the average baseline.</li> </ul> <p><strong>Error Analysis &amp; Residuals</strong></p> <p>From the residual plots:</p> <ul> <li>The <strong>residuals are centered around 0</strong>, showing no systematic over- or under-prediction bias.</li> <li>The <strong>scatter appears random</strong>, suggesting the model generalizes reasonably well — no clear trend of errors increasing for certain predicted values.</li> <li>The <strong>histogram of residuals</strong> is approximately symmetric, meaning errors are balanced on both sides of the true value.</li> </ul> <p><strong>Strengths &amp; Weaknesses</strong></p> <table> <thead> <tr> <th style="text-align: left;">Strength</th> <th style="text-align: left;">Explanation</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Low average prediction error</td> <td style="text-align: left;">MAE ≈ 0.46 is good for subjective rating data.</td> </tr> <tr> <td style="text-align: left;">Balanced residuals</td> <td style="text-align: left;">Indicates stable learning and no consistent bias.</td> </tr> <tr> <td style="text-align: left;">Beats baseline</td> <td style="text-align: left;">Clear improvement over mean predictor baseline.</td> </tr> </tbody> </table> <table> <thead> <tr> <th style="text-align: left;">Weakness</th> <th style="text-align: left;">Explanation</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Moderate R²</td> <td style="text-align: left;">Model doesn’t capture all variability — some randomness in labels remains.</td> </tr> <tr> <td style="text-align: left;">Slight noise sensitivity</td> <td style="text-align: left;">RMSE &gt; MAE suggests a few higher-error samples.</td> </tr> </tbody> </table> <p><strong>Conclusion of Numerical Results</strong></p> <p>The final MLP regression model achieved an MAE of <strong>0.4626</strong>, RMSE of <strong>0.7211</strong>, and R² of <strong>0.2857</strong> on the test set, clearly outperforming the mean predictor baseline (MAE = 0.6709, RMSE = 0.8532, R² = 0.0). These results show that the model effectively captures meaningful nonlinear relationships between input features and wine quality ratings. While the explained variance remains moderate, the model demonstrates consistent, unbiased predictions with small errors, which aligns with expectations for this dataset’s inherent subjectivity and noise. Residual analyses confirmed no significant bias, indicating good generalization. Overall, the trained model provides a reasonable balance between accuracy and interpretability for this regression task.</p> <h3 id=82-residual-analysis>8.2 Residual Analysis</h3> <p>Residual plots help us visualize the model’s bias and error distribution: - Residuals close to 0 → unbiased predictions. - Random scatter → no systematic bias. - Wide or patterned scatter → heteroscedasticity or model misfit.</p> <p>We generated two key residual plots:</p> <h4 id=residual-plot-interpretation-residuals-vs-predicted>Residual Plot Interpretation (Residuals vs Predicted)</h4> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/08-residuals_vs_predicted.png data-desc-position=bottom><img alt="Residuals vs Predicted" src=../images/08-residuals_vs_predicted.png></a></p> <p><strong>Visual Behavior</strong></p> <ul> <li>The <strong>horizontal red dashed line</strong> at 0 represents perfect predictions (no error).</li> <li>Each point shows the residual (True – Predicted) for a test sample at its predicted quality value.</li> </ul> <p><strong>Observations</strong></p> <ol> <li> <p><strong>Residuals cluster around 0:</strong> Most points lie close to the zero line, indicating that predictions are centered and <strong>unbiased</strong> on average.</p> </li> <li> <p><strong>No clear trend across predicted quality:</strong> The residuals appear randomly distributed for predicted values (4–7), showing that the model <strong>does not systematically over- or under-predict</strong> at any particular quality level.</p> </li> <li> <p><strong>Discrete residual values:</strong> Because wine quality ratings are <strong>integer-based (1–10)</strong>, both predictions and actuals fall into discrete bins, creating visible “stripes.” This is normal and not a model defect.</p> </li> <li> <p><strong>No major outliers:</strong> There are no extreme deviations (e.g., residuals &gt; ±3). The largest residuals are around –3 and +2, which are acceptable considering the rating scale.</p> </li> </ol> <p><strong>Interpretation</strong></p> <p>This plot confirms that:</p> <ul> <li>The model’s predictions are <strong>fairly well-calibrated</strong> — errors fluctuate symmetrically around zero.</li> <li>There’s <strong>no heteroscedasticity</strong> (variance of errors remains constant across the prediction range).</li> <li>The MLP model <strong>generalizes consistently</strong> across all predicted quality levels without major bias.</li> </ul> <p><strong>Conclusion</strong></p> <p>The residual plot shows that prediction errors are centered near zero, with no clear upward or downward trend, indicating that the model’s predictions are unbiased and stable across the quality range. The residuals form discrete bands due to the integer nature of wine quality scores. The absence of large outliers or funnel-shaped patterns suggests constant variance of errors (homoscedasticity), implying that the model generalizes consistently across all predicted values.</p> <h4 id=residuals-distributiontest-set-interpretation>Residuals Distribution(Test Set) Interpretation</h4> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../images/08-residuals_distribution.png data-desc-position=bottom><img alt="Residuals Distribution" src=../images/08-residuals_distribution.png></a></p> <p><strong>Visual Behavior</strong></p> <ul> <li>The plot shows how residuals (True – Predicted) are distributed across the test samples.</li> <li>The <strong>red dashed line at 0</strong> indicates perfect predictions (no error).</li> </ul> <p><strong>Observations</strong></p> <ol> <li> <p><strong>Strong central peak near 0:</strong> The majority of residuals fall around 0, confirming that the model’s predictions are <strong>well-centered</strong> and <strong>unbiased</strong> overall.</p> </li> <li> <p><strong>Symmetrical distribution:</strong> The histogram is approximately symmetric, with residuals equally likely to be slightly positive or slightly negative. → This means the model doesn’t systematically overpredict or underpredict.</p> </li> <li> <p><strong>Small tails on both sides:</strong> A few samples deviate by ±2 to ±3, but such outliers are rare. → Suggests stable generalization and no extreme mispredictions.</p> </li> <li> <p><strong>Discrete bins:</strong> The “bar-like” distribution arises because the dataset labels are <strong>integer quality scores</strong>, and predictions were rounded or quantized, resulting in discrete residual values.</p> </li> </ol> <p><strong>Interpretation</strong></p> <ul> <li> <p>The residuals follow a <strong>near-normal, zero-centered pattern</strong>, indicating:</p> </li> <li> <p><strong>Low bias</strong></p> </li> <li><strong>Consistent prediction spread</strong></li> <li><strong>Minimal outliers</strong></li> <li>This confirms that the MLP regressor generalizes well without skewing predictions toward high or low quality values.</li> </ul> <p><strong>Conclusion</strong></p> <p>The residual distribution shows a strong peak around zero, indicating that the model’s predictions are unbiased overall. The residuals are approximately symmetric, with small counts for larger positive and negative errors, suggesting stable generalization. The discrete bar structure reflects the integer nature of wine quality ratings. The lack of long tails or heavy skew confirms that the model rarely makes large errors, and its prediction noise is well-balanced around the true values.</p> <h2 id=general-interpretation-and-conclusion>General Interpretation and Conclusion</h2> <h3 id=83-interpretation><strong>8.3 Interpretation</strong></h3> <ul> <li><strong>Moderate MAE / RMSE:</strong> The model’s predictions are close to true values on average (MAE ≈ 0.46, RMSE ≈ 0.72). The small gap between MAE and RMSE indicates that large outliers are rare.</li> <li><strong>Reasonable R² (≈ 0.29):</strong> The MLP explains roughly 29% of the variance in wine quality — consistent with expectations for this noisy, subjective dataset.</li> <li><strong>Baseline Comparison:</strong> The MLP clearly outperforms the mean predictor (MAE 0.67 → 0.46, RMSE 0.85 → 0.72, R² 0.00 → 0.29), confirming that the model learned meaningful relationships rather than simply guessing the average.</li> <li><strong>Residuals:</strong> Residuals are centered near zero and show no clear pattern or trend, demonstrating that the model is unbiased and generalizes consistently across the prediction range.</li> </ul> <h3 id=84-conclusion><strong>8.4 Conclusion</strong></h3> <p>The final MLP regressor achieved solid predictive accuracy, with an MAE of approximately 0.46, RMSE of 0.72, and R² of 0.29 on the held-out test set. These results indicate that the model captures meaningful nonlinear patterns while maintaining generalization. Compared to a mean predictor baseline, it reduced both MAE and RMSE by about 30%, confirming genuine learning. Residual analyses revealed well-centered, symmetric error distributions without significant bias or heteroscedasticity. Overall, the model demonstrates reliable performance and balanced generalization for this regression task, effectively predicting wine quality within about half a quality point on average.</p> <hr> <p><em>Note</em>: AI assistance was used for code scaffolding, documentation, and figure generation. The authors understand and can explain all parts of the solution; plagiarism policies were respected.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="November 20, 2025 11:31:06 UTC">November 20, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="November 20, 2025 11:31:06 UTC">November 20, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:thomaschiari@gmail.com>thomaschiari</a> </nav> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/LuccaHiratsuca class=md-author title=@LuccaHiratsuca> <img src="https://avatars.githubusercontent.com/u/104103173?v=4&size=72" alt=LuccaHiratsuca> </a> <a href=https://github.com/FeMCDias class=md-author title=@FeMCDias> <img src="https://avatars.githubusercontent.com/u/101530321?v=4&size=72" alt=FeMCDias> </a> <a href=https://github.com/thomaschiari class=md-author title=@thomaschiari> <img src="https://avatars.githubusercontent.com/u/73441789?v=4&size=72" alt=thomaschiari> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking", "navigation.expand"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=https://unpkg.com/mathjax/es5/tex-mml-chtml.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js></script> <script src=https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>